<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>SlidesGen</title>
  </head>
  <body>
    <div id="left" style="float: left; width: 45%;min-height: 500px;">
      <textarea id="markdown" style="width: 100%;height: 100%;float:left;">
```
<section>
<!-- .slide: data-background-image="https://sjqzhang.github.io/slidesgen/assets/loop_03.gif"  data-background-opacity="0.07" -->
  <div style="height:480px">
        <canvas data-chart="line" >
My first dataset,  65, 59, 80, 81, 56, 55, 40
<!-- This is a comment -->
My second dataset, 28, 48, 40, 19, 86, 27, 90
<!-- 
{ 
"data" : {
  "labels" : ["Enero", "Febrero", "Marzo", "Avril", "Mayo", "Junio", "Julio"],
  "datasets" : [{ "borderColor": "#0f0", "borderDash": ["5","10"] }, { "borderColor": "#0ff" } ]
  }
}
-->

        </canvas>
  </div>
</section>
```
<!---->
## table
<!-- .slide: data-background-image="https://sjqzhang.github.io/slidesgen/assets/loop_01.gif"  data-background-opacity="0.07" --> 
|1|2|3|
|--|--|--|
|4|5|6|

<!---->

# page1
<!-- .slide: data-background-image="https://sjqzhang.github.io/slidesgen/assets/loop_19.gif"  data-background-opacity="0.07" -->
### content1
<!-- .element: class="fragment" -->
### content2
<!-- .element: class="fragment" -->


<!---->

# page2
<!-- .slide: data-background-image="https://sjqzhang.github.io/slidesgen/assets/loop_10.gif"  data-background-opacity="0.07" -->
### content1
<!-- .element: class="fragment" -->
### content2
<!-- .element: class="fragment" -->

<!---->

# page3
<!-- .slide: data-background-image="https://sjqzhang.github.io/slidesgen/assets/loop_11.gif"  data-background-opacity="0.07" -->
### content1
<!-- .element: class="fragment" -->
### content2
<!-- .element: class="fragment" -->

<!---->

# page4
<!-- .slide: data-background-image="https://sjqzhang.github.io/slidesgen/assets/loop_12.gif"  data-background-opacity="0.07" -->
### content1
<!-- .element: class="fragment" -->
### content2
<!-- .element: class="fragment" -->

<!---->

# page5
<!-- .slide: data-background-image="https://sjqzhang.github.io/slidesgen/assets/loop_13.gif"  data-background-opacity="0.07" -->
### content1
<!-- .element: class="fragment" -->
### content2
<!-- .element: class="fragment" -->

<!---->

# page6
<!-- .slide: data-background-image="https://sjqzhang.github.io/slidesgen/assets/loop_14.gif"  data-background-opacity="0.07" -->
### content1
<!-- .element: class="fragment" -->
### content2
<!-- .element: class="fragment" -->

<!---->

# page7
<!-- .slide: data-background-image="https://sjqzhang.github.io/slidesgen/assets/loop_15.gif"  data-background-opacity="0.07" -->
### content1
<!-- .element: class="fragment" -->
### content2
<!-- .element: class="fragment" -->
<!---->
# page8
<!-- .slide: data-background-image="https://sjqzhang.github.io/slidesgen/assets/loop_16.gif"  data-background-opacity="0.07" -->
### content1
<!-- .element: class="fragment" -->
### content2
<!-- .element: class="fragment" -->

<!---->
# End
      </textarea>
      <button id="middle" style="float:right;width: 50px;overfloat:hidden;" value="xxx">View</button>
    </div>
    
    <div id="right" style="float: right; width: 49%;min-height: 500px;">
      <iframe id="slides" src="right.html" style="width: 100%;height: 100%;"></iframe>
    </div>
  </body>

  <!-- import jquery from cdn-->

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

  <script>
    // when document is ready

    // 字符串格式化方法
String.prototype.format = function(args) {
	var result = this;
	if (arguments.length > 0) {
		if (arguments.length == 1 && typeof (args) == "object") {
			for (var key in args) {
				if(args[key]!=undefined){
					var reg = new RegExp("({" + key + "})", "g");
					result = result.replace(reg, args[key]);
				}
			}
		}
		else {
			for (var i = 0; i < arguments.length; i++) {
				if (arguments[i] != undefined) {
					var reg= new RegExp("({)" + i + "(})", "g");
					result = result.replace(reg, arguments[i]);
				}
			}
		}
	}
	return result;
};

    
    $(document).ready(function () {


      



// set left div height to window height by css

      function init() {

      var reduceHeight=10;
      $("#middle").css("height", $(window).height()-reduceHeight + "px");
      $("#middle").css("width", "50px");
      // set left div height to window height by css
      $("#left").css("width", ($(window).width()/2-2) + "px");
      $("#right").css("width", ($(window).width()/2-20) + "px");
      $("#markdown").css("width", ($(window).width()/2-60) + "px");
      $("#markdown").css("height", $(window).height() + "px");
      // set textarea height to window height by css
      $("textarea").css("height", $(window).height()-reduceHeight + "px");
      // set right div height to window height by css
      $("#right").css("height", $(window).height()-reduceHeight + "px");
      // set iframe height to window height by css
      $("iframe").css("height", $(window).height()-reduceHeight + "px");

      //$('#middle').css('padding-top',$(window).height()/2+'px')
      

      }
      init()

      $(window).resize(function(){
        init()
      })


      // translate markdown to reveal.js slides

      function tran(md) {

       var tpl=`
       <section data-markdown {options}>
        <script type="text/template">
           {section}
        <\/script>
    </section>
       `


       //md=md.replace(/^\s*/img,'')
        var ss=[]
        var slides=md.split(/\<\!----\>/ig)
        for(var i=0;i<slides.length;i++) {
            var s=$.trim(slides[i])

            
            var m=s.match(/```section([\s\S]+?)```|```([\s\S]+?)```/ig)
            if (m) {
                
              ss.push(m[0].replace(/^```|^````section|```$/ig,''))

            } else {
              ss.push(tpl.format({section:slides[i]}))
            }
        }


        return ss.join("\n")



      }

      $('#middle').dblclick(function(){

        $('#markdown').toggle()
        if($('#markdown:visible').length>0) {
          init()         
        } else {
          $("#left").css("width",  "60px"); 
          $("#right").css("width", ($(window).width()-85) + "px"); 
        }

      })

      $('#middle').click(function(){

          $('#slides').attr('src','right.html')

         var t= setTimeout(function(){
           if($("#slides").contents().find('.slides').length>0) {

            var val=tran($('textarea').val())
            $("#slides").contents().find('.slides').html(val)
            $("#slides").contents().find('#btnClick').trigger('click')
            clearTimeout(t)
           }
          },200)

    


      })


      //get textarea value set to iframe 

      // $('textarea').change(function(){
      // })


  

       
    });


  </script>
</html>
